# ドキュメント規約

このドキュメントは、プロジェクトで使用するドキュメントの品質と一貫性を保つためのルールを定義します。

> **Note**: すべてのドキュメントは読み手の理解を促進し、保守性を向上させることを目的とします。

## 基本原則

1. **簡潔性**: 冗長な表現を避け、必要な情報を最小限の文字数で伝える
2. **論理性**: 情報を適切な順序で構造化し、読み手が自然に理解できる流れを作る
3. **完全性**: 必要な情報を漏れなく含め、読み手が追加質問なしに行動できるようにする
4. **明確性**: 曖昧な表現を避け、具体的で誤解の余地がない文章を書く

## 出力規則

- すべての文書は日本語で作成する
- Markdown形式を適切に活用し、視認性を高める
- 見出し、箇条書き、コードブロックを効果的に使用する
- 長文を避け、一文一意を心がける

## GitHub Issue作成時

- **タイトル**: 問題または要望を一文で明確に表現
- **背景/概要**: なぜこのissueが必要なのかを簡潔に説明
- **現状**: 現在の状態や問題点を具体的に記述
- **期待する結果**: 解決後のあるべき姿を明確に定義
- **受け入れ条件**: 完了と判断するための具体的な基準をリスト化
- **補足情報**: 関連するリンク、スクリーンショット、技術的制約など

## プルリクエスト作成時

- **タイトル**: 変更内容を端的に表現
- **概要**: この変更が何を解決するのか
- **変更内容**: 主要な変更点を箇条書きで列挙
- **関連Issue**: 関連するissue番号への参照
- **注意事項**: レビュアーが知っておくべき特記事項

## 開発者向けドキュメント作成時

- **目的**: このドキュメントが何を説明するのか
- **前提条件**: 読み手に求められる知識や環境
- **手順**: ステップバイステップの明確な指示
- **コード例**: 必要に応じて実行可能なサンプルコード
- **トラブルシューティング**: よくある問題と解決方法
- **参考リンク**: 関連ドキュメントやリソース

## コードコメントの規約

### 基本原則

- コメントは「なぜ」を説明し、「何を」はコード自体に語らせる
- 自明なコードにはコメントを付けない（冗長なコメントは避ける）
- コメントは常に最新の状態に保つ（古いコメントは削除または更新する）
- 日本語でコメントを記述する

### 関数・メソッドのコメント

複雑なロジックや重要な関数には、以下の情報を含むコメントを付ける：

```typescript
/**
 * 迷路内の最短経路を探索する
 *
 * @param maze - 探索対象の迷路オブジェクト
 * @param start - 開始地点の座標
 * @param goal - 目標地点の座標
 * @returns 最短経路の座標配列。経路が存在しない場合はnull
 * @throws {InvalidMazeError} 迷路が無効な場合
 */
function findShortestPath(
  maze: Maze,
  start: Position,
  goal: Position
): Position[] | null {
  // 実装...
}
```

**記載すべき要素:**
- 関数の目的と概要
- パラメータの説明（`@param`）
- 戻り値の説明（`@returns`）
- 例外の説明（`@throws`）（必要な場合のみ）

### インラインコメント

複雑なロジックや直感的でない処理には、インラインコメントを付ける：

```typescript
// プレイヤーの位置が壁と重ならないように補正
// Canvas座標系では左上が(0,0)のため、Y軸の計算に注意
const adjustedY = canvas.height - player.y - player.height;
```

**付けるべき場合:**
- アルゴリズムの重要なステップ
- 技術的な制約や仕様
- 一時的な回避策（TODOと併用）
- パフォーマンス最適化の理由

### TODOコメント

将来の改善点や未完了タスクには、TODOコメントを付ける：

```typescript
// TODO: キャッシュ機構を追加してパフォーマンスを改善する
// TODO(#123): Issue #123の修正後にこの回避策を削除
```

**書き方:**
- `TODO:`で始める
- 関連するissue番号があれば記載する
- 具体的な改善内容を記述する

### 禁止事項

- コミットログで十分な情報は避ける（変更履歴や作成者情報など）
- コメントアウトされた古いコードを残さない
- 意味のないコメント（例: `// ループ処理`）

## READMEの規約

### 必須セクション

すべてのREADMEには、以下のセクションを含める：

1. **プロジェクト概要**: 何を実現するプロジェクトか
2. **前提条件**: 必要な環境やツール
3. **インストール手順**: セットアップ方法
4. **使用方法**: 基本的な使い方
5. **開発方法**: 開発者向けの情報（該当する場合）

### 推奨セクション

必要に応じて以下を追加する：

- **技術スタック**: 使用している主要な技術
- **プロジェクト構成**: ディレクトリ構造の説明
- **トラブルシューティング**: よくある問題と解決方法
- **貢献方法**: コントリビューション方法（オープンソースの場合）
- **ライセンス**: プロジェクトのライセンス

### 書き方のルール

- Markdown形式で記述する
- 見出しは階層的に構造化する（`#`、`##`、`###`）
- コードブロックには言語を明示する（例: `` ```typescript ``）
- 手順は番号付きリストで記載する
- 重要な注意事項は引用ブロック（`>`）で強調する

## APIドキュメントの規約

### エンドポイント定義

各APIエンドポイントには、以下の情報を記載する：

```markdown
### GET /api/mazes/:id

迷路データを取得します。

**パラメータ:**
- `id` (string, required): 迷路のID

**レスポンス:**
- **200 OK**: 成功時
  ```json
  {
    "id": "maze-001",
    "width": 10,
    "height": 10,
    "data": [[0, 1, 0, ...], ...]
  }
  ```
- **404 Not Found**: 迷路が見つからない場合

**エラーレスポンス:**
```json
{
  "error": "Maze not found"
}
```
```

**記載すべき要素:**
- HTTPメソッドとパス
- 説明
- パラメータ（パス、クエリ、ボディ）
- レスポンス形式（成功時・エラー時）
- ステータスコード

### 型定義の記述

共有型定義には、JSDocコメントを付ける：

```typescript
/**
 * 迷路の構造を表す型
 */
export interface Maze {
  /** 迷路の一意識別子 */
  id: string;
  /** 迷路の幅（セル数） */
  width: number;
  /** 迷路の高さ（セル数） */
  height: number;
  /** 迷路データ（0=通路、1=壁） */
  data: number[][];
}
```

### APIドキュメントの配置

- フロントエンド用APIドキュメント: `frontend/docs/api.md`
- バックエンドAPIドキュメント: `backend/docs/api.md`
- 共有型定義: `lib/README.md`に記載

## 品質チェックリスト

文書完成時に以下を確認すること：
- [ ] 不要な情報が含まれていないか
- [ ] 必要な情報が欠けていないか
- [ ] 論理的な順序で構成されているか
- [ ] 専門用語は適切に使用されているか
- [ ] 読み手のレベルに合った表現になっているか
- [ ] 具体的で行動可能な内容になっているか

## ドキュメントの更新ルール

- コードを変更したら、関連するドキュメントも同時に更新する
- 古い情報が残らないように、定期的に見直す
- 破壊的変更がある場合は、CHANGELOG.mdに記録する（該当する場合）

## 参考資料

- [コーディング規約](./coding-rules.md) - コードスタイルの基本ルール
- [テストルール](./testing-rules.md) - テストドキュメントの書き方
- [プロジェクト構造ルール](./structure-rules.md) - ドキュメントの配置場所
